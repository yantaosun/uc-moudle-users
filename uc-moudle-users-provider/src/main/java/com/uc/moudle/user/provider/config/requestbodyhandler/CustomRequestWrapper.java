package com.uc.moudle.user.provider.config.requestbodyhandler;import org.slf4j.Logger;import org.slf4j.LoggerFactory;import javax.servlet.ReadListener;import javax.servlet.ServletInputStream;import javax.servlet.http.HttpServletRequest;import javax.servlet.http.HttpServletRequestWrapper;import java.io.BufferedReader;import java.io.ByteArrayInputStream;import java.io.IOException;import java.io.InputStreamReader;/** * @author 9527 * @ClassName CustomRequestWrapper * @Date 2020/2/15 * @Description TODO * @Version 1.0 */public class CustomRequestWrapper extends HttpServletRequestWrapper {    private Logger logger = LoggerFactory.getLogger(CustomRequestWrapper.class);    private byte[] requestBody;    public CustomRequestWrapper(HttpServletRequest request) {        super(request);        requestBody = getRequestBody(request).getBytes();    }    public byte[] getRequestBody() {        return requestBody;    }    @Override    public ServletInputStream getInputStream() throws IOException {        ByteArrayInputStream byteArrayInputStream = new ByteArrayInputStream(requestBody);        ServletInputStream servletInputStream = new ServletInputStream() {            @Override            public boolean isFinished() {                return false;            }            @Override            public boolean isReady() {                return false;            }            @Override            public void setReadListener(ReadListener readListener) {            }            @Override            public int read() throws IOException {                return byteArrayInputStream.read();            }        };        return servletInputStream;    }    @Override    public BufferedReader getReader() throws IOException {        return new BufferedReader(new InputStreamReader(getInputStream()));    }    public  String getRequestBody(HttpServletRequest request) {        StringBuffer stringBuffer = new StringBuffer();        try (ServletInputStream servletInputStream = request.getInputStream()){            String line = null;            BufferedReader bufferedReader = new BufferedReader(new InputStreamReader(servletInputStream));            while ((line = bufferedReader.readLine()) != null) {                stringBuffer.append(line);            }        } catch (IOException e) {            logger.error(">>>> error occurred while get request inputStream, error message={} <<<<",e.getMessage());            e.printStackTrace();        }        return stringBuffer.toString();    }}